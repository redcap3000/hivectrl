<!DOCTYPE html>
<html>
    <head>
		<title>Cryptoez</title>
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
         <script src="https://d3js.org/d3-color.v1.min.js"></script>
        <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
        <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/styles.css"/>
        <script type="text/javascript" src="util.js"></script>
        <script type="text/javascript" src="openweather.js"></script>
         <script type="text/javascript" src="hive.js"></script>
         <script type="text/javascript" src="nicehash.js"></script>
         <script type="text/javascript" src="twominers.js"></script>
    </head>
    <body>
    <div id="topBar">
        <div id="openWeatherData"></div>             
        <div id="openWeatherData2"></div>
    </div>
    
    <div class="hiveContainer" id="hiveWorkersData"></div>
    <div class="dev" id="colorRefScale"></div>
    <div class="hiveContainer" id="hiveSelectedWorkerId">
        </div>
        <div class="hiveContainer" id="hiveSelectedCard">
        </div>
        <div class="hiveContainer" id="hiveSelectedIdxs">
        </div>
        <!-- <button onClick="getHiveFlightsheets()">Get Flightsheets</button> -->
        <div class="hiveContainer" id="hiveFlightsheets">
        </div>
        <script>  
            altM = {
                rigs : {},
                getData : true,
                dataInt : false,
                selectedCardIdxs:[],
                selectedWorkerId: 0,
                selectedCard:'',

            }
            var rigs = {}
            var getData = true
            var dataInt = false
            var selectedCardIdxs=[]
            var selectedWorkerId=0
            var selectedCard=''
          
            hisHash={}
           
            getHiveData()
            getOpenWeather()
            getNicehashApi()
            // listen to changes initated by click handler
            setInterval(
                function(){
                    if(selectedCardIdxs.length > 0){
                        let sCardString = ['<ul>']
                        selectedCardIdxs.filter(function(c){
                            sCardString.push('<li>'+c+'</li>')
                        })
                        sCardString.push('</ul>')
                        sCardString.push('<table><tr><th>miner</th><th>Device String</th></tr>')
                        let miners = ['gminer','trex','cryptodredge']
                        miners.filter(function(miner){
                            var getP=getDeviceIndexPrefix(miner,selectedCardIdxs)
                            sCardString.push('<tr><td>'+miner+'</td><td>'  +getP+'</td></tr>')
                        })
                        sCardString.push('</table>')
                        writeToDom('hiveSelectedIdxs',sCardString.join(''))
                    }
                    if(selectedWorkerId  !== 0){
                        writeToDom('hiveSelectedWorkerId',selectedWorkerId)
                    }
                    if(selectedCard  != ''){
                        writeToDom('hiveSelectedCard',selectedCard)
                    }
                },1000
            )
            if(getData === true){
                
                dataInt = setInterval(function(){
                    getHiveData()
                },1000 * 10)
                dataInt2 = setInterval(function(){
                    getOpenWeather()
                },1000 * 60 * 5)
                dataInt3 = setInterval(function(){
                    getNicehashApi()
                },1000 * 15)
                dataInt4 = setInterval(function(){
                    getTwoMinersApi()
                },1000 * 3)
            }else{
                dataInt = false
                dataInt2 = false
            }
        </script>
	
    <div id="bottomBar">
        <div class="hiveContainer" id="hiveFarmData"></div>

        <div class="hiveContainer" id="hiveHashrateData"></div>
        <div id="nicehashData"></div>
        <div id="twoMinersData"></div>
        <div id="twoMinersDataLastBlocks"></div>
    </div>
    </body>
</html>